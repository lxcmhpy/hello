webpackJsonp([45,58],{E8Z1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){return{visible:!1,addDepartmentForm:{sortOrder:"",name:"",pidName:"",status:!0},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},dialogTitle:"",errorName:!1,handelType:0,parentNode:"",departmentId:""}},inject:["reload"],methods:{showModal:function(e,t){this.visible=!0,this.handelType=e,0==e?(this.dialogTitle="新增部门",this.parentNode=t,this.addDepartmentForm.pidName=t.parentNodeName,this.addDepartmentForm.sortOrder=t.departmentLength+1):2==e&&(this.dialogTitle="修改部门",this.parentNode=t.parentNode,this.departmentId=t.row.id,this.addDepartmentForm.name=t.row.name,this.addDepartmentForm.status=0==t.row.status,this.addDepartmentForm.sortOrder=t.row.sortOrder,this.addDepartmentForm.pidName=t.parentNode.parentNodeName)},closeDialog:function(){this.visible=!1,this.$refs.addDepartmentForm.resetFields(),this.errorName=!1},focusName:function(){this.errorName=!1},addOrEditDepartment:function(e){var t=this;this.$refs[e].validate(function(e){e&&!t.errorName&&t.departmentNameRepeat()})},departmentNameRepeat:function(){var e=this,t={oid:this.parentNode.parentNodeId,name:this.addDepartmentForm.name};this.$store.dispatch("hasDepartmentName",t).then(function(t){t.data.id?e.errorName=!0:e.addOrEditDepartmentSure()},function(e){})},addOrEditDepartmentSure:function(){var e=this;this.addDepartmentForm.oid=this.parentNode.parentNodeId,this.addDepartmentForm.id=0==this.handelType?"":this.departmentId,this.addDepartmentForm,this.$store.dispatch("addDepartment",this.addDepartmentForm).then(function(t){e.$emit("getAllOrgan2",e.addDepartmentForm.oid),e.$message({type:"success",message:0==e.handelType?"添加成功!":"修改成功"}),e.visible=!1},function(e){})},getOrganDetail:function(e){}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"close-on-click-modal":!1,width:"35%"},on:{"update:visible":function(t){e.visible=t},close:e.closeDialog}},[a("el-form",{ref:"addDepartmentForm",staticClass:"errorTipForm",attrs:{model:e.addDepartmentForm,rules:e.rules,"label-width":"80px"}},[a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[a("el-input",{on:{focus:e.focusName},model:{value:e.addDepartmentForm.name,callback:function(t){e.$set(e.addDepartmentForm,"name",t)},expression:"addDepartmentForm.name"}})],1),e._v(" "),e.errorName?a("span",{staticClass:"errorInput"},[e._v("该部门名称已存在")]):e._e()],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"所属机构",prop:"pidName"}},[a("el-input",{model:{value:e.addDepartmentForm.pidName,callback:function(t){e.$set(e.addDepartmentForm,"pidName",t)},expression:"addDepartmentForm.pidName"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"序号",prop:"sortOrder"}},[a("el-input",{model:{value:e.addDepartmentForm.sortOrder,callback:function(t){e.$set(e.addDepartmentForm,"sortOrder",t)},expression:"addDepartmentForm.sortOrder"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-switch",{attrs:{"active-color":"#4573D0"},model:{value:e.addDepartmentForm.status,callback:function(t){e.$set(e.addDepartmentForm,"status",t)},expression:"addDepartmentForm.status"}})],1)],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOrEditDepartment("addDepartmentForm")}}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var i=a("VU/8")(r,n,!1,function(e){a("rxiX")},null,null);t.default=i.exports},F6hk:function(e,t){},ebDT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={watch:{filterText:function(e){this.$refs.tree.filter(e)}},data:function(){return{filterText:"",selectCurrentTreeName:"",organData:[],defaultProps:{children:"children",label:"label"},tableData:[],departLevel:0,defaultExpandedKeys:[],currentPage:1,pageSize:10,totalPage:0,currentOrganId:"",departmentLength:0}},components:{addDepartment:a("E8Z1").default},inject:["reload"],methods:{filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleNodeClick:function(e){this.selectCurrentTreeName=e.label,this.tableData=[],this.currentOrganId=e.id,this.getSelectOrgan(this.currentOrganId)},nodeExpand:function(e,t,a){},getAllOrgan:function(e){var t=this;this.$store.dispatch("getAllOrgan").then(function(a){t.defaultExpandedKeys.push(a.data[0].id),t.selectCurrentTreeName=t.selectCurrentTreeName?t.selectCurrentTreeName:a.data[0].label,a.data[0].children&&a.data[0].children.length>0&&a.data[0].children.forEach(function(e){t.defaultExpandedKeys.push(e.id)}),t.organData=a.data,t.defaultExpandedKeys,t.organData,t.currentOrganId="root"==e?a.data[0].id:e,t.getSelectOrgan()},function(e){})},getSelectOrgan:function(){var e=this,t={oid:this.currentOrganId,current:this.currentPage,size:this.pageSize};this.$store.dispatch("getDepartments",t).then(function(t){e.tableData=t.data.records,e.totalPage=t.data.total},function(e){})},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.getSelectOrgan()},handleCurrentChange:function(e){this.currentPage=e,this.getSelectOrgan()},addDepartment:function(){var e={parentNodeId:this.currentOrganId,parentNodeName:this.selectCurrentTreeName,departmentLength:this.totalPage};this.$refs.addDepartmentRef.showModal(0,e)},editDepartment:function(e){var t={row:e,parentNode:{parentNodeId:this.currentOrganId,parentNodeName:this.selectCurrentTreeName}};this.$refs.addDepartmentRef.showModal(2,t)},deleteDepartment:function(e){var t=this;this.$confirm("确认删除该部门?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("deleteDepartment",e).then(function(e){t.getAllOrgan(t.currentOrganId),t.$message({type:"success",message:"删除成功!"})},function(e){})}).catch(function(){})}},mounted:function(){},created:function(){this.getAllOrgan("root")}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"com_searchAndpageBoxPadding"},[a("div",{staticClass:"fullBox departBox"},[a("div",{staticClass:"departOrUserTree"},[a("p",[e._v("机构列表")]),e._v(" "),a("div",{staticClass:"searchDepartBox"},[a("el-input",{attrs:{placeholder:"输入机构名"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[a("el-button",{attrs:{slot:"append",size:"mini",icon:"el-icon-search"},slot:"append"})],1)],1),e._v(" "),a("div",{staticClass:"treeBox"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.organData,props:e.defaultProps,"node-key":"id","filter-node-method":e.filterNode,"default-expanded-keys":e.defaultExpandedKeys},on:{"node-expand":e.nodeExpand,"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:n.children&&n.children.length>0?"iconfont law-icon_shou_bag":""}),e._v(" "),a("span",{class:n.children?"":"hasMarginLeft"},[e._v(e._s(r.label))])])])}}])})],1)]),e._v(" "),a("div",{staticClass:"departTable"},[a("p",[e._v(e._s(e.selectCurrentTreeName))]),e._v(" "),a("div",{staticClass:"handelBtn"},[a("div",[e._v("部门列表")]),e._v(" "),a("div",[a("el-dropdown",{attrs:{"split-button":"",type:"primary",size:"medium"},on:{click:e.addDepartment}},[a("i",{staticClass:"iconfont law-icon_weihu"}),e._v("新增部门\n            "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v("批量添加")]),e._v(" "),a("el-dropdown-item",[e._v("批量导入")])],1)],1)],1)]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:"70%"}},[a("el-table-column",{attrs:{prop:"name",label:"部门名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("span",{},[a("span",[e._v(e._s(0==t.row.status?"正常":"注销"))])])}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editDepartment(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteDepartment(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"paginationBox"},[a("el-pagination",{attrs:{"current-page":e.currentPage,background:"","page-sizes":[10,20,30,40],layout:"prev, pager, next,sizes,jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("addDepartment",{ref:"addDepartmentRef",on:{getAllOrgan2:e.getAllOrgan}})],1)])},staticRenderFns:[]};var i=a("VU/8")(r,n,!1,function(e){a("F6hk")},null,null);t.default=i.exports},rxiX:function(e,t){}});
//# sourceMappingURL=45.5555a7a5781903014ba8.js.map