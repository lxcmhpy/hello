webpackJsonp([43,68,69,70],{"6SSo":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{visible:!1,addRoleForm:{name:"",description:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},dialogTitle:"",errorOrganName:!1,handelType:0,editRoleId:""}},inject:["reload"],methods:{showModal:function(e,t){this.visible=!0,this.handelType=e,0==e?this.dialogTitle="新增角色":2==e&&(this.dialogTitle="修改角色",this.addRoleForm.name=t.name,this.addRoleForm.description=t.description,this.editRoleId=t.id)},closeDialog:function(){this.visible=!1,this.$refs.addRoleForm.resetFields()},focusOrganName:function(){this.errorOrganName=!1},blurOrganName:function(){var e=this;this.addOrganForm.name&&this.$store.dispatch("hasOrganName",this.addOrganForm.name).then(function(t){t.data.id?e.errorOrganName=!0:e.errorOrganName=!1},function(e){})},addOrEditRole:function(e){var t=this;this.$refs[e].validate(function(e){e&&!t.errorOrganName&&(t.handelType?(t.addRoleForm.id=t.editRoleId,t.$store.dispatch("editRole",t.addRoleForm).then(function(e){t.$message({type:"success",message:"修改成功"}),t.visible=!1,t.reload()},function(e){})):t.$store.dispatch("addRole",t.addRoleForm).then(function(e){t.$message({type:"success",message:"添加成功!"}),t.visible=!1,t.reload()},function(e){}))})},getOrganDetail:function(e){}}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"close-on-click-modal":!1,width:"35%"},on:{"update:visible":function(t){e.visible=t},close:e.closeDialog}},[n("el-form",{ref:"addRoleForm",attrs:{model:e.addRoleForm,rules:e.rules,"label-width":"80px"}},[n("div",{staticClass:"item"},[n("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[n("el-input",{model:{value:e.addRoleForm.name,callback:function(t){e.$set(e.addRoleForm,"name",t)},expression:"addRoleForm.name"}})],1)],1),e._v(" "),n("div",{staticClass:"item"},[n("el-form-item",{attrs:{label:"角色介绍",prop:"description"}},[n("el-input",{model:{value:e.addRoleForm.description,callback:function(t){e.$set(e.addRoleForm,"description",t)},expression:"addRoleForm.description"}})],1)],1)]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOrEditRole("addRoleForm")}}},[e._v("确 定")])],1)],1)},staticRenderFns:[]},o=n("VU/8")(i,a,!1,null,null,null);t.default=o.exports},KB63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{visible:!1,organData:[],defaultProps:{children:"children",label:"label"},roleId:""}},methods:{showModal:function(e){this.visible=!0,this.roleId=e},closeDialog:function(){this.visible=!1},getOrgan:function(){var e=this;this.$store.dispatch("getAllOrgan").then(function(t){e.organData=t.data,e.getRoleBindOrgan()},function(e){})},getRoleBindOrgan:function(){var e=this;this.$store.dispatch("getRoleBindOrgan",this.roleId).then(function(t){var n=[];t.data.forEach(function(e){n.push(e.organId)}),e.$refs.organTree.setCheckedKeys(n)},function(e){})},bindOrganSure:function(){var e=this;this.$refs.organTree.getCheckedKeys();var t={roleId:this.roleId,organIds:this.$refs.organTree.getCheckedKeys()};this.$store.dispatch("roleBindOrgan",t).then(function(t){e.visible=!1,e.$message({type:"success",message:"绑定成功"})},function(e){})},openDialog:function(){this.getOrgan()}},created:function(){}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"绑定机构",visible:e.visible,"close-on-click-modal":!1,width:"35%",top:"30px"},on:{"update:visible":function(t){e.visible=t},close:e.closeDialog,open:e.openDialog}},[n("div",[n("el-tree",{ref:"organTree",attrs:{data:e.organData,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps}})],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.bindOrganSure()}}},[e._v("确 定")])],1)])},staticRenderFns:[]},o=n("VU/8")(i,a,!1,null,null,null);t.default=o.exports},bMuk:function(e,t){},"c+ii":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("6SSo"),a=n("u6zf"),o=n("KB63"),r={data:function(){return{tableData:[],dicSearchForm:{name:""},currentPage:1,pageSize:10,totalPage:0}},components:{addEditRole:i.default,bindMenu:a.default,bindOrgan:o.default},inject:["reload"],methods:{editRole:function(e){this.$refs.addEditRoleRef.showModal(2,e)},deleteRole:function(e){var t=this;this.$confirm("确认删除该角色?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("deleteRole",e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.reload()},function(e){})}).catch(function(){})},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.getSelectOrgan()},handleCurrentChange:function(e){this.currentPage=e,this.getSelectOrgan()},getRoles:function(){var e=this,t={current:this.currentPage,size:this.pageSize,name:this.dicSearchForm.name};this.$store.dispatch("getRoles",t).then(function(t){e.tableData=t.data.records,e.totalPage=t.data.total},function(e){})},addRole:function(){this.$refs.addEditRoleRef.showModal(0,"")},bindMenu:function(e){this.$refs.bindMenuRef.showModal(e)},bindOrgan:function(e){this.$refs.bindOrganRef.showModal(e)}},created:function(){this.getRoles()}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"com_searchAndpageBoxPadding"},[n("div",{staticClass:"searchAndpageBox",attrs:{id:"roleBox"}},[n("div",{staticClass:"handlePart"},[n("div",{staticClass:"search"},[n("el-form",{attrs:{inline:!0,model:e.dicSearchForm}},[n("el-form-item",{attrs:{label:"角色名称"}},[n("el-input",{attrs:{placeholder:"输入角色名称"},model:{value:e.dicSearchForm.name,callback:function(t){e.$set(e.dicSearchForm,"name",t)},expression:"dicSearchForm.name"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-search"},on:{click:e.getRoles}},[e._v("查询")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:e.addRole}},[e._v("添加角色")])],1)],1)],1)]),e._v(" "),n("div",{staticClass:"tablePart"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:"100%"}},[n("el-table-column",{attrs:{prop:"name",label:"角色名称",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"description",label:"角色介绍",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.bindMenu(t.row.id)}}},[e._v("菜单权限")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.bindOrgan(t.row.id)}}},[e._v("绑定机构")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.editRole(t.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.deleteRole(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"paginationBox"},[n("el-pagination",{attrs:{"current-page":e.currentPage,background:"","page-sizes":[10,20,30,40],layout:"prev, pager, next,sizes,jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),n("addEditRole",{ref:"addEditRoleRef"}),e._v(" "),n("bindMenu",{ref:"bindMenuRef"}),e._v(" "),n("bindOrgan",{ref:"bindOrganRef"})],1)])},staticRenderFns:[]};var l=n("VU/8")(r,s,!1,function(e){n("bMuk")},null,null);t.default=l.exports},u6zf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{visible:!1,menuData:[],defaultProps:{children:"children",label:"title"},roleId:""}},methods:{showModal:function(e){this.visible=!0,this.roleId=e},closeDialog:function(){this.visible=!1},getMenu:function(){var e=this;this.$store.dispatch("getTreePermission").then(function(t){e.menuData=t.data,e.getRoleBindMenu()},function(e){})},getRoleBindMenu:function(){var e=this;this.$store.dispatch("getRoleBindMenu",this.roleId).then(function(t){var n=[];t.data.forEach(function(e){n.push(e.permissionId)}),e.$refs.menuTree.setCheckedKeys(n)},function(e){})},bindMenu:function(){var e=this;this.$refs.menuTree.getCheckedKeys();var t={roleId:this.roleId,permissionIds:this.$refs.menuTree.getCheckedKeys()};this.$store.dispatch("roleBindMenu",t).then(function(t){e.visible=!1,e.$message({type:"success",message:"绑定成功"})},function(e){})},openDialog:function(){this.getMenu()}},created:function(){}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"绑定菜单",visible:e.visible,"close-on-click-modal":!1,width:"35%",top:"30px"},on:{"update:visible":function(t){e.visible=t},close:e.closeDialog,open:e.openDialog}},[n("div",[n("el-tree",{ref:"menuTree",attrs:{data:e.menuData,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps}})],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.bindMenu()}}},[e._v("确 定")])],1)])},staticRenderFns:[]},o=n("VU/8")(i,a,!1,null,null,null);t.default=o.exports}});
//# sourceMappingURL=43.60b334a44b269bbc48a4.js.map