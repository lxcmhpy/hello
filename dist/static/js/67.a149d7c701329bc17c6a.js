webpackJsonp([67],{"A+Mu":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});new(r("7+uW").default);function a(e,t,r){!/^1(3|4|5|6|7|8)\d{9}$/.test(t)&&t&&r(new Error("手机号格式错误")),r()}function s(e,t,r){!/(^\d{8}(0\d|10|11|12)([0-2]\d|30|31)\d{3}$)|(^\d{6}(18|19|20)\d{2}(0\d|10|11|12)([0-2]\d|30|31)\d{3}(\d|X|x)$)/.test(t)&&t&&r(new Error("身份证格式错误")),r()}var i={data:function(){var e=this;return{depss:[],visible:!1,titleMap:{addEquipment:"新增用户",editEquipment:"编辑用户"},dialogStatus:"",parentNode:"",getOrganList:[],departments:[],addUserForm:{id:"",username:"",password:"123456",mobile:"",nickName:"",IDnumber:"",category:"",organId:"",organTitle:"",departmentId:"",departmentTitle:"",Provincial:"",Ministerial:"",Maritime:"",Other:""},rules:{username:[{required:!0,message:"请输入登录用户名",trigger:"blur"},{min:6,message:"长度大于6个字符",trigger:"blur"},{validator:function(t,r,a){e.$store.dispatch("hasUsername",r).then(function(e){a()}).catch(function(e){a("用户名重复")})},trigger:"blur"}],mobile:[{validator:a,trigger:"blur"}],organId:[{required:!0,message:"请选择机构",trigger:"change"}],IDnumber:[{validator:s,trigger:"blur"}]},rowData:""}},mounted:function(){},methods:{showModal:function(e){var t=this;this.visible=!0,this.dialogStatus="addEquipment",this.$nextTick(function(){t.$refs.addUserForm.resetFields()}),this.parentNode=e,this.getCurrentOrganAndChild()},closeDialog:function(){this.visible=!1,this.$refs.addUserForm.resetFields()},handelEdit:function(e){this.visible=!0,this.dialogStatus="editEquipment",this.parentNode={parentNodeId:e.organId,parentNodeName:e.userDeparment},this.getCurrentOrganAndChild(),this.rowData=e},getCurrentOrganAndChild:function(){var e=this;this.$store.dispatch("getCurrentAndNextOrgan",this.parentNode.parentNodeId).then(function(t){e.getOrganList=t.data},function(e){})},getDepartment:function(e){var t=this,r={organId:e};this.$store.dispatch("getDepartmentsNoPage",r).then(function(e){t.departments=e.data},function(e){})},save:function(){var e=this;this.$refs.addUserForm.validate(function(t){if(t)if("addEquipment"===e.dialogStatus)e.addUserForm,e.$store.dispatch("addUser",e.addUserForm).then(function(t){e.$message({showClose:!0,message:"新增用户成功",type:"success"}),e.visible=!1,e.$emit("uploadaaa","1")}).catch(function(t){e.$message({showClose:!0,message:t,type:"error"})});else if("editEquipment"===e.dialogStatus){e.addUserForm;e.addUserForm.id,e.addUserForm.username,e.addUserForm.mobile,e.addUserForm.nickName,e.addUserForm.IDnumber,e.addUserForm.category,e.addUserForm.organId,e.addUserForm.organTitle,e.addUserForm.departmentId,e.addUserForm.departmentTitle,e.addUserForm.Provincial,e.addUserForm.Ministerial,e.addUserForm.Maritime,e.addUserForm.Other;e.$store.dispatch("updateUser",e.addUserForm).then(function(t){e.$message({showClose:!0,message:"修改用户成功",type:"success"}),e.$emit("uploadaaa"),e.visible=!1}).catch(function(t){e.$message({showClose:!0,message:t,type:"error"})})}})},resetForm:function(){var e=this;this.visible=!1,this.$nextTick(function(){e.$refs.addUserForm.resetFields()})}},watch:{visible:function(e){!1===e&&(this.addUserForm={id:"",username:"",password:"",mobile:"",nickName:"",IDnumber:"",category:"",organId:"",organTitle:"",departmentId:"",departmentTitle:"",Provincial:"",Ministerial:"",Maritime:"",Other:""})}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.titleMap[e.dialogStatus],"custom-class":"leftDialog",visible:e.visible,top:"0",width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[r("el-form",{ref:"addUserForm",staticClass:"addOrganClass",attrs:{model:e.addUserForm,rules:e.rules,"label-width":"100px","close-on-click-modal":!1},on:{close:e.closeDialog}},[r("div",{staticClass:"part"},[r("p",{staticClass:"titleP"},[e._v("登录信息")]),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"登录用户名",prop:"username"}},[r("el-input",{ref:"username",attrs:{disabled:"editEquipment"===e.dialogStatus},model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1)],1)]),e._v(" "),r("div",{staticClass:"part"},[r("p",{staticClass:"titleP"},[e._v("基本信息")]),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"真实姓名"}},[r("el-input",{model:{value:e.addUserForm.nickName,callback:function(t){e.$set(e.addUserForm,"nickName",t)},expression:"addUserForm.nickName"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"身份证号码",prop:"IDnumber"}},[r("el-input",{ref:"IDnumber",model:{value:e.addUserForm.IDnumber,callback:function(t){e.$set(e.addUserForm,"IDnumber",t)},expression:"addUserForm.IDnumber"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"联系方式",prop:"mobile"}},[r("el-input",{ref:"mobile",model:{value:e.addUserForm.mobile,callback:function(t){e.$set(e.addUserForm,"mobile",t)},expression:"addUserForm.mobile"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"执法门类"}},[r("el-input",{model:{value:e.addUserForm.category,callback:function(t){e.$set(e.addUserForm,"category",t)},expression:"addUserForm.category"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"执法机构",prop:"organId"}},[r("el-select",{attrs:{placeholder:"请选择执法机构"},on:{change:e.getDepartment},model:{value:e.addUserForm.organId,callback:function(t){e.$set(e.addUserForm,"organId",t)},expression:"addUserForm.organId"}},e._l(e.getOrganList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"所属部门",prop:"departmentId"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addUserForm.departmentId,callback:function(t){e.$set(e.addUserForm,"departmentId",t)},expression:"addUserForm.departmentId"}},e._l(e.departments,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)]),e._v(" "),r("div",{staticClass:"part"},[r("p",{staticClass:"titleP"},[e._v("证件信息")]),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"省级证件号"}},[r("el-input",{model:{value:e.addUserForm.Provincial,callback:function(t){e.$set(e.addUserForm,"Provincial",t)},expression:"addUserForm.Provincial"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"部级证件号"}},[r("el-input",{model:{value:e.addUserForm.Ministerial,callback:function(t){e.$set(e.addUserForm,"Ministerial",t)},expression:"addUserForm.Ministerial"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"海事证件号"}},[r("el-input",{model:{value:e.addUserForm.Maritime,callback:function(t){e.$set(e.addUserForm,"Maritime",t)},expression:"addUserForm.Maritime"}})],1)],1),e._v(" "),r("div",{staticClass:"item"},[r("el-form-item",{attrs:{label:"其他证件号"}},[r("el-input",{model:{value:e.addUserForm.Other,callback:function(t){e.$set(e.addUserForm,"Other",t)},expression:"addUserForm.Other"}})],1)],1)])]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.resetForm}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)},staticRenderFns:[]},o=r("VU/8")(i,d,!1,null,null,null);t.default=o.exports}});
//# sourceMappingURL=67.a149d7c701329bc17c6a.js.map