webpackJsonp([50],{"9Y0e":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("bOdI"),n=a.n(l),i={name:"el-tree-select",props:{props:{type:Object,default:function(){return{value:"id",label:"title",children:"children"}}},options:{type:Array,default:function(){return[]}},value:{type:Number,default:function(){return null}},clearable:{type:Boolean,default:function(){return!0}},accordion:{type:Boolean,default:function(){return!1}}},data:function(){return{valueId:this.value,valueTitle:"",defaultExpandedKey:[]}},mounted:function(){this.initHandle()},methods:{initHandle:function(){this.valueId&&(this.valueTitle=this.$refs.selectTree.getNode(this.valueId).data[this.props.label],this.$refs.selectTree.setCurrentKey(this.valueId),this.defaultExpandedKey=[this.valueId]),this.$nextTick(function(){var e=document.querySelectorAll(".el-scrollbar .el-select-dropdown__wrap")[0],t=document.querySelectorAll(".el-scrollbar .el-scrollbar__bar");e.style.cssText="margin: 0px; max-height: none; overflow: hidden;",t.forEach(function(e){return e.style.width=0})})},handleNodeClick:function(e){this.valueTitle=e[this.props.label],this.valueId=e[this.props.value],this.$emit("getValue",this.valueId),this.defaultExpandedKey=[]},clearHandle:function(){this.valueTitle="",this.valueId=null,this.defaultExpandedKey=[],this.clearSelected(),this.$emit("getValue",null)},clearSelected:function(){document.querySelectorAll("#tree-option .el-tree-node").forEach(function(e){return e.classList.remove("is-current")})}},watch:{value:function(e){this.valueId=this.value,this.initHandle()}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{value:e.valueTitle,clearable:e.clearable},on:{clear:e.clearHandle}},[a("el-option",{attrs:{value:e.valueTitle,label:e.valueTitle}},[a("el-tree",{ref:"selectTree",attrs:{id:"tree-option",accordion:e.accordion,data:e.options,props:e.props,"node-key":e.props.value,"default-expanded-keys":e.defaultExpandedKey},on:{"node-click":e.handleNodeClick}})],1)],1)},staticRenderFns:[]};var o,s=a("VU/8")(i,r,!1,function(e){a("KxJN")},"data-v-39ca728e",null).exports,d=(o={watch:{},data:function(){return{tableData:[],currentPage:1,pageSize:10,total:0,dialogTitle:"",isShowDialog:!1,typeList:[{id:-1,name:"目录"},{id:0,name:"菜单"},{id:1,name:"按钮"}],buttonTypeList:["add","delete","enable","other","edit"],addItemObj:{pLevel:"",permTypes:"",id:"",parentId:"",name:"",showAlways:"",type:"",title:"",path:"",component:"",icon:"",url:"",buttonType:[],sortOrder:""},rules:{title:[{required:!0,message:"请输入菜单标题",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}]},props:{label:"title",value:"id"},parentData:[]}},components:{},inject:["reload"],methods:{searchTable:function(){var e=this;this.$store.dispatch("getTreePermission").then(function(t){e.tableData=t.data,e.total=t.data.length},function(e){})},tableAdd:function(e){var t=this;this.dialogTitle="新增",this.isShowDialog=!0,this.addItemObj.parentId=e.id,setTimeout(function(){t.$refs.elSelectTreeObj.valueTitle=e.title,t.$refs.elSelectTreeObj.valueId=e.id})},addItem:function(){var e=this;this.dialogTitle="新增",this.isShowDialog=!0,setTimeout(function(){e.$refs.elSelectTreeObj.clearHandle()})},editItem:function(e){var t=this;t.addItemObj={pLevel:e.pLevel,permTypes:e.permTypes,id:e.id,parentId:e.parentId,name:e.name,showAlways:e.showAlways,type:e.type,title:e.title,path:e.path,component:e.component,icon:e.icon,url:e.url,buttonType:e.buttonType.length>0?e.buttonType.split(","):[],sortOrder:e.sortOrder},t.dialogTitle="修改",t.isShowDialog=!0,setTimeout(function(){var a=t.searchNameById(e,"","","",t.tableData)?t.searchNameById(e,"","","",t.tableData):"";t.$refs.elSelectTreeObj.valueTitle=a,t.$refs.elSelectTreeObj.valueId=a?e.parentId:""})},changeButtonType:function(e){},sureAdd:function(){var e=this;if(this.verifyAcceptObj()){var t=this;"新增"===t.dialogTitle&&-1===t.addItemObj.type&&(t.addItemObj.pLevel=0),t.addItemObj.buttonType=t.addItemObj.buttonType.join(","),this.$store.dispatch("addPermission",t.addItemObj).then(function(a){200===a.code&&(t.isShowDialog=!1,e.$message({type:"success",message:t.dialogTitle+"成功！"}),t.searchTable())},function(t){e.$message({type:"error",message:t})})}},deleteItem:function(e){var t=this,a=this;this.$store.dispatch("deletePermission",e.id).then(function(e){200===e.code&&(t.$message({type:"success",message:"删除成功！"}),a.searchTable())},function(e){})},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},hindleChanged:function(e){this.addItemObj.parentId=e},searchNameById:function(e,t,a,l,n){if(null===e.parentId||void 0===e.parentId||""===e.parentId.toString().replace(/\s+/g,""))return"无";var i,r,o,s={};for(o=(s=n||this.tableData).length;o;){if(r=s[--o],e.parentId===r.id)return r.title;if(r.children&&(i=this.searchNameById(e,"","","",r.children)))return i.title}},searchIdByName:function(e,t){var a,l,n;for(n=t.length;n;){if(e===(l=t[--n]).title)return l;if(l.children&&(a=this.searchNameById(e,l.children)))return a.id}},verifyAcceptObj:function(){var e=!0,t=this;for(var a in t.rules){this.$refs.addItemObj.validateField(a,function(l){if(""!==l&&!0===e){e=!1;var n=t.$refs[a].elForm.fields;for(var i in n)n[i].labelFor===a&&(n[i].label,t.$alert(n[i].label+"填写错误","提示",{confirmButtonText:"确定",callback:function(e){}}))}})}return e}},mounted:function(){},created:function(){this.searchTable()}},n()(o,"components",{elSelectTree:s}),n()(o,"watch",{isShowDialog:function(e){e||(this.addItemObj={pLevel:"",permTypes:"",id:"",parentId:"",name:"",showAlways:"",type:"",title:"",path:"",component:"",icon:"",url:"",buttonType:[],sortOrder:""})},"addItemObj.type":function(e){-1===e&&(this.$refs.elSelectTreeObj.clearHandle(),this.addItemObj.parentId="")}}),o),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"com_searchAndpageBoxPadding"},[a("div",{staticClass:"searchAndpageBox",attrs:{id:"menuBox"}},[a("div",{staticClass:"handlePart"},[a("div",{staticClass:"leftTitle"},[e._v("菜单列表")]),e._v(" "),a("div",{staticClass:"rightTitle"},[a("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:e.addItem}},[e._v("新增菜单")])],1)]),e._v(" "),a("div",{staticClass:"tablePart"},[a("el-table",{attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),stripe:"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},height:"100%"},on:{"row-click":e.tableAdd}},[a("el-table-column",{attrs:{prop:"title",label:"名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"icon",label:"图标",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(-1===t.row.type?"目录":0===t.row.type?"菜单":"按钮"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"parentId",label:"上级菜单",align:"center",formatter:e.searchNameById}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"菜单URL",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"component",label:"菜单组件",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"permTypes",label:"授权标识",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sortOrder",label:"排序",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),e.editItem(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),e.deleteItem(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"paginationBox"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,background:"","page-sizes":[10,20,30,40],layout:"prev, pager, next,sizes,jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.isShowDialog,"close-on-click-modal":!1,width:"35%"},on:{"update:visible":function(t){e.isShowDialog=t}}},[a("el-form",{ref:"addItemObj",staticClass:"errorTipForm",attrs:{model:e.addItemObj,rules:e.rules,"label-width":"100px"}},[a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"菜单类型",prop:"type"}},[e._l(e.typeList,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id},model:{value:e.addItemObj.type,callback:function(t){e.$set(e.addItemObj,"type",t)},expression:"addItemObj.type"}},[e._v(e._s(t.name)+"\n              ")])}),e._v(" "),a("el-input",{ref:"type",staticStyle:{display:"none"},model:{value:e.addItemObj.type,callback:function(t){e.$set(e.addItemObj,"type",t)},expression:"addItemObj.type"}})],2)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"菜单图标",prop:"icon"}},[a("el-input",{ref:"icon",model:{value:e.addItemObj.icon,callback:function(t){e.$set(e.addItemObj,"icon",t)},expression:"addItemObj.icon"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"菜单名称",prop:"name"}},[a("el-input",{ref:"name",model:{value:e.addItemObj.name,callback:function(t){e.$set(e.addItemObj,"name",t)},expression:"addItemObj.name"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"菜单标题",prop:"title"}},[a("el-input",{ref:"title",model:{value:e.addItemObj.title,callback:function(t){e.$set(e.addItemObj,"title",t)},expression:"addItemObj.title"}})],1)],1),e._v(" "),-1!==e.addItemObj.type?a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"上级菜单",prop:"parentId"}},[a("elSelectTree",{ref:"elSelectTreeObj",attrs:{options:e.tableData,accordion:!0,props:e.props},on:{getValue:e.hindleChanged}}),e._v(" "),a("el-input",{ref:"parentId",staticStyle:{display:"none"},model:{value:e.addItemObj.parentId,callback:function(t){e.$set(e.addItemObj,"parentId",t)},expression:"addItemObj.parentId"}})],1)],1):e._e(),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"页面权限类型",prop:"permTypes"}},[a("el-input",{ref:"permTypes",model:{value:e.addItemObj.permTypes,callback:function(t){e.$set(e.addItemObj,"permTypes",t)},expression:"addItemObj.permTypes"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"按钮权限类型",prop:"buttonType"}},[a("el-select",{attrs:{multiple:"","multiple-limit":0,placeholder:"请选择"},on:{change:e.changeButtonType},model:{value:e.addItemObj.buttonType,callback:function(t){e.$set(e.addItemObj,"buttonType",t)},expression:"addItemObj.buttonType"}},e._l(e.buttonTypeList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),e._v(" "),a("el-input",{ref:"buttonType",staticStyle:{display:"none"},model:{value:e.addItemObj.buttonType.length,callback:function(t){e.$set(e.addItemObj.buttonType,"length",t)},expression:"addItemObj.buttonType.length"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"菜单URL",prop:"path"}},[a("el-input",{ref:"path",model:{value:e.addItemObj.path,callback:function(t){e.$set(e.addItemObj,"path",t)},expression:"addItemObj.path"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"前端组件",prop:"component"}},[a("el-input",{ref:"component",model:{value:e.addItemObj.component,callback:function(t){e.$set(e.addItemObj,"component",t)},expression:"addItemObj.component"}})],1)],1),e._v(" "),a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"排序编号",prop:"sortOrder"}},[a("el-input",{model:{value:e.addItemObj.sortOrder,callback:function(t){e.$set(e.addItemObj,"sortOrder",t)},expression:"addItemObj.sortOrder"}})],1)],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isShowDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.sureAdd}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(d,c,!1,function(e){a("tgas")},null,null);t.default=p.exports},KxJN:function(e,t){},tgas:function(e,t){}});
//# sourceMappingURL=50.acbc5299b0f0784eab3f.js.map